version: 2

models:
  - name: movie_abstracts_en_cleansed
    description: "Movie abstracts in English"
    columns:
      - name: movie_id
        description: "alphanumeric unique identifier of the movie"
        tests:
          - not_null
          - unique
          - dbt_utils.relationships_where:
              to: ref('all_movie_aliases_iso')
              field: movie_id
              to_condition: language_iso_639_1 = 'en'
      - name: abstract
        description: "Movie abstract in English"
        tests:
          - not_null